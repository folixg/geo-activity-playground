{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"<p>Recording all my outside activities with a GPS tracker has led to a pretty big data collection. Using Strava one can already take a look at this data and have a place to store it. On Statshunters there are some nice analyses of the data, for instance regarding explorer tiles.</p> <p>This project here provides some additional analyses of the data. It is not meant to be comprehensible, rather just to satisfy my curiosity.</p> <p>You can find the code on GitHub. If you would like to use this yourself or contribute, feel free to reach out via the contact options from my website.</p>"},{"location":"directory-layout/","title":"Directory Layout","text":"<p>There are a bunch of files that need to be given to this set of scripts, are used as intermediate files or generated as output. In order to make it clear where everything is, the following document lists all the paths which are relevant to the script.</p> <p>Everything is relative to a base directory which can be passed with the <code>--basedir</code> option to the scripts.</p>"},{"location":"directory-layout/#input","title":"Input","text":"<p>The user has to put data into the following directories in order for it to be picked up.</p> <ul> <li> <p><code>Strava Export</code>: Contains the exported data from Strava.</p> </li> <li> <p><code>config.toml</code>: Configuration file</p> </li> </ul>"},{"location":"directory-layout/#output-and-cache","title":"Output and cache","text":"<p>The following directories serve as a cache. One can inspect this but doesn't need to work with that directly.</p> <ul> <li> <p><code>Explorer</code>: Things related to the explorer tiles.</p> <ul> <li><code>Per Activity</code>: A data frame with the tiles that have been visited within each activity. Each file is named with the activity ID like <code>2520340514.parquet</code>. The columns are <code>time</code>, <code>tile_x</code>, <code>tile_y</code>.</li> <li><code>first_time_per_tile.parquet</code>: A data frame with the first visit datetime for each explorer tile. Columns <code>time</code>, <code>tile_x</code>, <code>tile_y</code>.</li> <li><code>missing_tiles.geojson</code>: A GeoJSON file with square polygons for all missing tiles at the boundary of explored tiles.</li> <li><code>missing_tiles.gpx</code>: The same, just expressed as square tracks in the GPX format.</li> <li><code>explored.geojson</code>: A GeoJSON file with square polygons for all explored tiles.</li> <li><code>explored.gpx</code>: The same, just expressed as square tracks in the GPX format.</li> </ul> </li> <li> <p><code>Heatmaps</code>: Will contain heatmap images generated from the data. They will be called like <code>Cluster-1.png</code> with increasing numbers. When one re-generates the heatmaps, the old files will be deleted to make sure that even if the numbers of clusters has been reduced there are no old files remaining.</p> </li> <li> <p><code>Open Street Map Tiles</code>: Cached tiles from the Open Street Map. The substructure is <code>zoom/x/y.png</code>. Each image has a size of 256\u00d7256 pixels.</p> </li> <li> <p><code>Strava API</code>: Everything that is downloaded via the Strava API is stored in this subtree.</p> <ul> <li><code>Data</code>: The time series data for each activity as a data frame stored in the Parquet format. Filenames are <code>2589868806.parquet</code> with the activity IDs. The column names are the following: <code>time</code>, <code>latitude</code>, <code>longitude</code> and optionally <code>distance</code>, <code>altitude</code>, <code>heartrate</code>.</li> <li><code>Metadata</code>: The activity objects from the <code>stravalib</code> Python library are stored here as Python pickle objects. The file names are time stamp of the activity start, like <code>start-1364228189.pickle</code>.</li> <li><code>strava_tokens.json</code>: Tokens for the Strava API. Contains the access and refresh tokens.</li> </ul> </li> <li> <p><code>Strava Export Cache</code>:</p> <ul> <li><code>Activities</code>: Same as <code>Strava API/Data</code>.</li> </ul> </li> </ul>"},{"location":"explorer-tiles/","title":"Explorer Tiles","text":""},{"location":"explorer-tiles/#what-are-explorer-tiles","title":"What are explorer tiles?","text":"<p>Maps accessible via the web browser are usually served as little image tiles. The Open Street Map uses the Web Mercator coordinate system to map from latitude and longitude to pixels on the map.</p> <p>Each tile is 256 \u00d7 256 pixels in size. The zoom levels zoom in by a factor of two. Therefore all the tiles are organized in a quad tree. As you zoom in, each tile gets split into four tiles which can then show more detail. The following prescription maps from latitude and longitude (given in degrees) to tile indices:</p> <pre><code>def compute_tile(lat: float, lon: float, zoom: int = 14) -&gt; tuple[int, int]:\n    x = np.radians(lon)\n    y = np.arcsinh(np.tan(np.radians(lat)))\n    x = (1 + x / np.pi) / 2\n    y = (1 - y / np.pi) / 2\n    n = 2**zoom\n    return int(x * n), int(y * n)\n</code></pre> <p>At zoom level 14 the tiles have a side length of roughly 1.5 km where I live. These tiles are used as the basis for explorer tiles. The basic idea is that every tile where you have at least one point in an activity is considered an explored tile.</p> <p>From your activities the program will extract all the tiles that you have visited. And then it does a few things with those.</p>"},{"location":"explorer-tiles/#maps-with-explorer-tiles","title":"Maps with explorer tiles","text":"<p>The most straightforward artifact is a map with all the tiles that you have explored. This is created in the GeoJSON format as that can encode polygons. You can then take a look at these maps with programs like GPXSee or online viewers like GeoJSON.io.</p> <p>The explored tiles map looks like this for the Hunsr\u00fcck area for me:</p> <p></p>"},{"location":"explorer-tiles/#missing-tiles","title":"Missing tiles","text":"<p>The next interesting question are the missing tiles. I often have little gaps and would like to see them easily. The program computes the boundary around the tiles that you have explored. This can be used to plan extensions of the explored area.</p> <p></p> <p>On Android one can use the OsmAnd app to display tracks and also try to visualize the missing tiles. Unfortunately GeoJSON is not supported, therefore one has to play some tricks. The missing tiles are also exported as a GPX file with a track for each missing tile. This looks strange, but it is a bit helpful with OsmAnd. This is how the file looks like in GPXSee:</p> <p></p> <p>Transfer this GPX file to OsmAnd and you can have it display the missing tiles such that you can extend your explored area systematically.</p>"},{"location":"heatmaps/","title":"Heatmaps","text":"<p>From all the points in your activities, one can generate nice heatmaps. This builds on the Strava local heatmap code.</p> <p>We don't generate a single heatmap for all your activities as this will not look great as soon as you have done an activity away from home. Rather we use a clustering algorithm to find all disjoint geographical clusters in your activities and generate one heatmap per cluster.</p> <p>For instance the heatmap generated from all my activities in the Randstad in the Netherlands:</p> <p></p>"}]}